!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=10)}({10:function(e,t,r){e.exports=r(11)},11:function(e,t){$((function(){var e;$(".payment-method").off("change"),$(".payment-method").on("change",(function(){"credit-card"==$(this).prop("id")?$(".credit-card").show():$(".credit-card").hide()})),$("#card-number, #card-expire, #card-secret").off("keypress"),$("#card-number, #card-expire, #card-secret").on("keypress",(function(e){(e.which<48||e.which>57)&&e.preventDefault()})),$("#card-number").off("keyup"),$("#card-number").on("keyup",(function(t){if(0!==$("#card-number").val().length){switch($("#card-number").val($("#card-number").val().replace(/\D/g,"").replace(/(\d{4})/g,"$1 ").trim()),function(e){if(!function(e){if(!/^[\d\-\s]+$/.test(e))return!1;for(var t=0,r=0,n=!1,a=e.replace(/\D/g,""),i=a.length-1;i>=0;i--){var s=a.charAt(i);r=parseInt(s,10),n&&(r*=2)>9&&(r-=9),t+=r,n=!n}return t%10==0}(e))return"";for(var t="",r=[{regEx:/^4[0-9]{5}/gi,cardType:"VISA"},{regEx:/^5[1-5][0-9]{4}/gi,cardType:"MASTERCARD"},{regEx:/^3[47][0-9]{3}/gi,cardType:"AMEX"},{regEx:/^(?:2131|1800|35\d{3})\d{11}$/gi,cardType:"JCB"}],n=0;n<r.length;n++)if(e.match(r[n].regEx)){t=r[n].cardType;break}if(0===e.indexOf("50")||0===e.indexOf("60")||0===e.indexOf("65"))for(var a="508500-508999|606985-607984|608001-608500|652150-653149".split("|"),i=0;i<a.length;i++){var s=parseInt(a[i].split("-")[0],10),l=parseInt(a[i].split("-")[1],10);if(e.substr(0,6)>=s&&e.substr(0,6)<=l&&e.length>=6){t="RUPAY";break}}return t}($("#card-number").val().replace(/\D/g,""))){case"VISA":"VISA"!==e&&$(".card-img").html('<img src="sunsun/svg/cc-visa.svg" class="img-fluid scale-image" alt="">'),e="VISA";break;case"MASTERCARD":"MASTERCARD"!==e&&$(".card-img").html('<img src="sunsun/svg/cc-mastercard.svg" class="img-fluid scale-image" alt="">'),e="MASTERCARD";break;case"AMEX":"AMEX"!==e&&$(".card-img").html('<img src="sunsun/svg/cc-amex.svg" class="img-fluid scale-image" alt="">'),e="AMEX";break;case"JCB":"JCB"!==e&&$(".card-img").html('<img src="sunsun/svg/cc-jcb.svg" class="img-fluid scale-image" alt="">'),e="JCB";break;default:"NONE"!==e&&$(".card-img").html('<img src="sunsun/svg/cc-blank.svg" class="img-fluid scale-image" alt="">'),e="NONE"}$(this).parent().find("span:first-child").css("display","inline"),$(this).removeClass("typing-none"),$(this).addClass("typing")}else console.log("bbb"),$(this).parent().find("span:first-child").css("display","none"),$(this).removeClass("typing"),$(this).addClass("typing-none")})),$("#card-expire").off("keyup"),$("#card-expire").on("keyup",(function(){if(0!==$("#card-expire").val().length){1===$("#card-expire").val().length&&$("#card-expire").val()>1&&$("#card-expire").val("0"+$("#card-expire").val()),$(this).parent().find("span:first-child").css("display","inline"),$(this).removeClass("typing-none"),$(this).addClass("typing");var e=$("#card-expire").val().replace(/\D/g,"").replace(/(\d{2})/g,"$1/").trim();6!=e.length&&3!=e.length||(e=e.slice(0,-1)),$("#card-expire").val(e)}else $(this).parent().find("span:first-child").css("display","none"),$(this).removeClass("typing"),$(this).addClass("typing-none")})),$("#card-secret").off("keyup"),$("#card-secret").on("keyup",(function(){if(0!==$("#card-secret").val().length){$(this).parent().find("span:first-child").css("display","inline"),$(this).removeClass("typing-none"),$(this).addClass("typing");var e=$("#card-secret").val().replace(/\D/g,"");$("#card-secret").val(e)}else $(this).parent().find("span:first-child").css("display","none"),$(this).removeClass("typing"),$(this).addClass("typing-none")})),$("#make_payment").off("click"),$("#make_payment").on("click",(function(){t()}));var t=function(){"1"===$("input[type=radio][name=payment-method]:checked").val()?n():r()}}));var r=function(){var e=$("form.booking").serializeArray();$("#Token").val(""),console.log(e),$.ajax({url:"/make_payment",type:"POST",data:e,dataType:"text",beforeSend:function(){loader.css({display:"block"})},success:function(e){void 0!==(e=JSON.parse(e)).error?(Swal.fire({icon:"warning",text:" 入力した情報を再確認してください。",confirmButtonColor:"#d7751e",confirmButtonText:"閉じる",width:350,showClass:{popup:"animated zoomIn faster"},hideClass:{popup:"animated zoomOut faster"},allowOutsideClick:!1}),$("p.note-error").remove(),$.each(e.error,(function(e,t){switch($("#"+t).css({border:"solid 1px #f50000"}),t){case"name":$("#"+t).parent().after('<p class="note-error node-text"> 入力されている名前は無効になっています。</p>');break;case"phone":$("#"+t).parent().after('<p class="note-error node-text"> 電話番号は無効になっています。</p>');break;case"email":$("#"+t).parent().after('<p class="note-error node-text"> ﾒｰﾙｱﾄﾞﾚｽは無効になっています。</p>')}})),$.each(e.clear,(function(e,t){$("#"+t).css({border:"solid 1px #ced4da"})}))):void 0!==e.status&&"success"==e.status?($("#bookingID").val(e.message.bookingID),$("#tranID").val(e.message.tranID),$("#completeForm").submit()):void 0!==e.status&&"error"==e.status&&Swal.fire({icon:"warning",text:e.message,confirmButtonColor:"#d7751e",confirmButtonText:"閉じる",width:350,showClass:{popup:"animated zoomIn faster"},hideClass:{popup:"animated zoomOut faster"},allowOutsideClick:!1})},complete:function(){loader.css({display:"none"})}})};function n(){if(""!=function(e){if(!function(e){if(!/^[\d\-\s]+$/.test(e))return!1;for(var t=0,r=0,n=!1,a=e.replace(/\D/g,""),i=a.length-1;i>=0;i--){var s=a.charAt(i);r=parseInt(s,10),n&&(r*=2)>9&&(r-=9),t+=r,n=!n}return t%10==0}(e))return"";for(var t="",r=[{regEx:/^4[0-9]{5}/gi,cardType:"VISA"},{regEx:/^5[1-5][0-9]{4}/gi,cardType:"MASTERCARD"},{regEx:/^3[47][0-9]{3}/gi,cardType:"AMEX"},{regEx:/^(?:2131|1800|35\d{3})\d{11}$/gi,cardType:"JCB"}],n=0;n<r.length;n++)if(e.match(r[n].regEx)){t=r[n].cardType;break}if(0===e.indexOf("50")||0===e.indexOf("60")||0===e.indexOf("65"))for(var a="508500-508999|606985-607984|608001-608500|652150-653149".split("|"),i=0;i<a.length;i++){var s=parseInt(a[i].split("-")[0],10),l=parseInt(a[i].split("-")[1],10);if(e.substr(0,6)>=s&&e.substr(0,6)<=l&&e.length>=6){t="RUPAY";break}}return t}($("#card-number").val().replace(/\D/g,""))){payment_init();var e=$("#card-number").val().replace(/\D/g,""),t=$("#card-expire").val(),r=$("#card-secret").val().replace(/\D/g,"");cardExpireMonth=t.split("/")[0],cardExpireYear="20"+t.split("/")[1],t=cardExpireYear.toString()+cardExpireMonth.toString(),Multipayment.getToken({cardno:e,expire:t,securitycode:r,tokennumber:1},execPurchase)}else $(".credit-card-line").addClass("error"),$(".credit-card-line2").addClass("error"),$(".cc-block").after('<p class="note-error node-text">無効なカード</p>')}"undefined"==typeof execPurchase&&(execPurchase=function(e){console.log(e),$("p.note-error").remove(),"000"!=e.resultCode?($(".credit-card-line").addClass("error"),$(".credit-card-line2").addClass("error"),$(".cc-block").after('<p class="note-error node-text">無効なカード</p>')):($(".credit-card-line").removeClass("error"),$(".credit-card-line2").removeClass("error"),$("#Token").val(e.tokenObject.token),r())}),function(e){e.fn.phoneFilter=function(t){return this.on("keydown keyup",(function(t){if("Backspace"!==t.key&&"undefined"!==t.key){var r,n=this.value.length,a=e(this).val();n<3&&a.indexOf("(")<=-1?r="("+a:4==n&&a.indexOf("(")>-1?r=a+")-":5==n?r=")"!=t.key?this.oldValue+")-"+t.key:a:6==n&&a.indexOf("-")<=-1?r="-"!=t.key?this.oldValue+"-"+t.key:a:9==n?(r=a+"-",e(this).attr("maxlength","14")):10==n?(console.log(t.key),r="-"!=t.key?this.oldValue+"-"+t.key:a):r=a;!0===/^[\+]?[(]?[0-9]{0,3}[)]?[-\s\.]?[0-9]{0,3}[-\s\.]?[0-9]{0,6}$/im.test(r)?(e(this).val(r),this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")&&(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd))}else this.oldValue=e(this).val(),this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd}))},e("#tel").phoneFilter((function(e){return!0})),e.fn.nameFilter=function(t){return this.on("keydown keyup",(function(t){if("Backspace"!==t.key&&"undefined"!==t.key){this.value.length;var r,n=e(this).val();!0!==/^[\p{Katakana}]+/im.test(r=n)?(e(this).val(r),this.oldValue=this.value,this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd):this.hasOwnProperty("oldValue")&&(this.value=this.oldValue,this.setSelectionRange(this.oldSelectionStart,this.oldSelectionEnd))}else this.oldValue=e(this).val(),this.oldSelectionStart=this.selectionStart,this.oldSelectionEnd=this.selectionEnd}))},e("#name").nameFilter((function(e){return!0}))}(jQuery)}});